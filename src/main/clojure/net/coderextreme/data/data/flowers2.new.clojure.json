{ "X3D": {
    "encoding":"UTF-8",
"@profile":"Immersive",
"@version":"4.0",
"@xsd:noNamespaceSchemaLocation":"https://www.web3d.org/specifications/x3d-4.0.xsd",
    "JSON schema":"https://www.web3d.org/specifications/x3d-4.0-JSONSchema.autogenerated.json",
"head": {
"component": [
{
"@name":"Scripting",
"@level":1
}
],
"meta": [
{
"@name":"title",
"@content":"flowers2.x3d"
},
{
"@name":"creator",
"@content":"John Carlson"
},
{
"@name":"transcriber",
"@content":"John Carlson"
},
{
"@name":"created",
"@content":"23 January 2005"
},
{
"@name":"modified",
"@content":"21 March 2018"
},
{
"@name":"description",
"@content":"2 random mathematical roses in spherical dimensions. rho = a + b * cos(c
* theta) * cos(d * phi)"
},
{
"@name":"identifier",
"@content":"https://coderextreme.net/X3DJSONLD/src/main/data/flowers2.x3d"
},
{
"@name":"generator",
"@content":"manually written"
},
{
"@name":"license",
"@content":"https://www.web3d.org/x3d/content/examples/license.html"
},
{
"@name":"translated",
"@content":"13 October 2024"
},
{
"@name":"generator",
"@content":"X3dToJson.xslt, https://www.web3d.org/x3d/stylesheets/X3dToJson.html"
},
{
"@name":"reference",
"@content":"X3D JSON encoding: https://www.web3d.org/wiki/index.php/X3D_JSON_Encoding"
}
]
},
"Scene": {
"-children":[
{ "NavigationInfo":
{
}
},
{ "Viewpoint":
{
"@description":"Two mathematical orbitals",
"@position":[0,0,50]
}
},
{ "Group":
{
"-children":[
{ "DirectionalLight":
{
"@direction":[1,1,1]
}
},
{ "ProtoDeclare":
{
"@name":"orbit",
"ProtoInterface": {
"field": [
{
"@name":"translation",
"@accessType":"inputOutput",
"@type":"SFVec3f",
"@value":[-8,0,0]
},
{
"@name":"diffuseColor",
"@accessType":"inputOutput",
"@type":"SFColor",
"@value":[1,0.5,0]
},
{
"@name":"specularColor",
"@accessType":"inputOutput",
"@type":"SFColor",
"@value":[1,0.5,0]
},
{
"@name":"transparency",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":0.75
}
]
},
"ProtoBody": {
"-children":[
{ "Group":
{
"-children":[
{ "TimeSensor":
{
"@DEF":"Clock",
"@cycleInterval":16.0,
"@loop":true
}
},
{ "OrientationInterpolator":
{
"@DEF":"OrbitPath",
"@key":[0,0.5,1],
"@keyValue":[1,0,0,0,1,0,0,3.14,1,0,0,6.28]
}
},
{ "Transform":
{
"@DEF":"OrbitTransform",
"IS": {
"connect": [
{
"@nodeField":"translation",
"@protoField":"translation"
}
]
},
"-children":[
{ "Shape":
{
"-appearance":
{ "Appearance":
{
"-material":
{ "Material":
{
"IS": {
"connect": [
{
"@nodeField":"diffuseColor",
"@protoField":"diffuseColor"
},
{
"@nodeField":"specularColor",
"@protoField":"specularColor"
},
{
"@nodeField":"transparency",
"@protoField":"transparency"
}
]
}
}
}
}
},
"-geometry":
{ "IndexedFaceSet":
{
"@DEF":"Orbit",
"@ccw":false,
"@convex":false,
"@coordIndex":[0,1,2,-1],
"-coord":
{ "Coordinate":
{
"@DEF":"OrbitCoordinates",
"@point":[0,0,1,0,1,0,1,0,0]
}
}
}
}
}
}
]
}
},
{ "Script":
{
"@DEF":"OrbitScript",
"field": [
{
"@name":"set_fraction",
"@accessType":"inputOnly",
"@type":"SFFloat"
},
{
"@name":"coordinates",
"@accessType":"inputOutput",
"@type":"MFVec3f"
},
{
"@name":"coordIndexes",
"@accessType":"inputOutput",
"@type":"MFInt32"
},
{
"@name":"e",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":5.0
},
{
"@name":"f",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":5.0
},
{
"@name":"g",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":5.0
},
{
"@name":"h",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":5.0
},
{
"@name":"resolution",
"@accessType":"inputOutput",
"@type":"SFInt32",
"@value":50
}
],
"#sourceCode":[
"",
"",
"\newline\newline\t\t\tfunction initialize() {\newline\t\t\t     generateCoordinates();\newline\t\t\t
var arrIndex = 0;\newline\t\t\t     for (var i = 0; i &lt; resolution-1; i++) {\newline\t\t\t\tfor
(var j = 0; j &lt; resolution-1; j++) {\newline\t\t\t\t     coordIndexes[arrIndex++]
= i*resolution+j;\newline\t\t\t\t     coordIndexes[arrIndex++] = i*resolution+j+1;\newline\t\t\t\t
coordIndexes[arrIndex++] = (i+1)*resolution+j+1;\newline\t\t\t\t     coordIndexes[arrIndex++]
= (i+1)*resolution+j;\newline\t\t\t\t     coordIndexes[arrIndex++] = -1;\newline\t\t\t\t}\newline\t\t\t
}\newline\t\t\t}\newline\newline\t\t\tfunction generateCoordinates() {\newline\t\t\t
var theta = 0.0;\newline\t\t\t     var phi = 0.0;\newline\t\t\t     var delta = (2
* 3.141592653) / (resolution-1);\newline\t\t\t     var arrIndex = 0;\newline\t\t\t
for (var i = 0; i &lt; resolution; i++) {\newline\t\t\t\tfor (var j = 0; j &lt; resolution;
j++) {\newline\t\t\t\t\tvar rho = e + f * Math.cos(g * theta) * Math.cos(h * phi);\newline\t\t\t\t\tcoordinates[arrIndex++]
= new SFVec3f(\newline\t\t\t\t\t\trho * Math.cos(phi) * Math.cos(theta),\newline\t\t\t\t\t\trho
* Math.cos(phi) * Math.sin(theta),\newline\t\t\t\t\t\trho * Math.sin(phi)\newline\t\t\t\t\t);\newline\t\t\t\t\ttheta
+= delta;\newline\t\t\t\t}\newline\t\t\t\tphi += delta;\newline\t\t\t     }\newline\t\t\t}\newline\newline\t\t\tfunction
set_fraction(fraction, eventTime) {\newline\t\t\t\tvar choice = Math.floor(Math.random()
* 4);\newline\t\t\t\tswitch (choice) {\newline\t\t\t\tcase 0:\newline\t\t\t\t\te +=
Math.floor(Math.random() * 2) * 2 - 1;\newline\t\t\t\t\tbreak;\newline\t\t\t\tcase
1:\newline\t\t\t\t\tf += Math.floor(Math.random() * 2) * 2 - 1;\newline\t\t\t\t\tbreak;\newline\t\t\t\tcase
2:\newline\t\t\t\t\tg += Math.floor(Math.random() * 2) * 2 - 1;\newline\t\t\t\t\tbreak;\newline\t\t\t\tcase
3:\newline\t\t\t\t\th += Math.floor(Math.random() * 2) * 2 - 1;\newline\t\t\t\t\tbreak;\newline\t\t\t\t}\newline\t\t\t\tif
(e &lt; 1) {\newline\t\t\t\t\tf = 10;\newline\t\t\t\t}\newline\t\t\t\tif (f &lt; 1) {\newline\t\t\t\t\tf
= 10;\newline\t\t\t\t}\newline\t\t\t\tif (g &lt; 1) {\newline\t\t\t\t\tg = 4;\newline\t\t\t\t}\newline\t\t\t\tif
(h &lt; 1) {\newline\t\t\t\t\th = 4;\newline\t\t\t\t}\newline\t\t\t\tgenerateCoordinates();\newline\t\t\t}\newline",
"",
""
]
}
},
{ "ROUTE":
{
"@fromField":"coordIndexes",
"@fromNode":"OrbitScript",
"@toField":"set_coordIndex",
"@toNode":"Orbit"
}
},
{ "ROUTE":
{
"@fromField":"coordinates",
"@fromNode":"OrbitScript",
"@toField":"point",
"@toNode":"OrbitCoordinates"
}
},
{ "ROUTE":
{
"@fromField":"fraction_changed",
"@fromNode":"Clock",
"@toField":"set_fraction",
"@toNode":"OrbitScript"
}
},
{ "ROUTE":
{
"@fromField":"value_changed",
"@fromNode":"OrbitPath",
"@toField":"rotation",
"@toNode":"OrbitTransform"
}
},
{ "ROUTE":
{
"@fromField":"fraction_changed",
"@fromNode":"Clock",
"@toField":"set_fraction",
"@toNode":"OrbitPath"
}
}
]
}
}
]
}
}
},
{ "ProtoInstance":
{
"@name":"orbit",
"fieldValue": [
{
"@name":"translation",
"@value":[-8,0,0]
},
{
"@name":"diffuseColor",
"@value":[1,0.5,0]
},
{
"@name":"specularColor",
"@value":[1,0.5,0]
},
{
"@name":"transparency",
"@value":0.75
}
]
}
},
{ "ProtoInstance":
{
"@name":"orbit",
"fieldValue": [
{
"@name":"translation",
"@value":[8,0,0]
},
{
"@name":"diffuseColor",
"@value":[0,0.5,1]
},
{
"@name":"specularColor",
"@value":[0,0.5,1]
},
{
"@name":"transparency",
"@value":0.5
}
]
}
}
]
}
}
]
}
  }
}