{ "X3D": {
    "encoding":"UTF-8",
    "@profile":"Full",
    "@version":"3.3",
    "@xsd:noNamespaceSchemaLocation":"http://www.web3d.org/specifications/x3d-3.3.xsd",
    "JSON schema":"https://www.web3d.org/specifications/x3d-3.3-JSONSchema.json",
    "head": {
        "meta": [
          {
            "@name":"comment",
            "@content":"World of Titania"
          },
          {
            "@name":"created",
            "@content":"Fri, 11 Sep 2015 17:20:16 GMT"
          },
          {
            "@name":"creator",
            "@content":"Holger Seelig"
          },
          {
            "@name":"generator",
            "@content":"Titania V1.2.2, http://titania.create3000.de"
          },
          {
            "@name":"modified",
            "@content":"Wed, 06 Jan 2016 23:48:58 GMT"
          },
          {
            "@name":"title",
            "@content":"Text"
          },
          {
            "@name":"translated",
            "@content":"06 September 2021"
          },
          {
            "@name":"generator",
            "@content":"X3dToJson.xslt, https://www.web3d.org/x3d/stylesheets/X3dToJson.html"
          },
          {
            "@name":"reference",
            "@content":"X3D JSON encoding: https://www.web3d.org/wiki/index.php/X3D_JSON_Encoding"
          }
        ]
    },
    "Scene": {
        "-children":[
          { "ProtoDeclare":
            {
              "@name":"LineRectangle2D",
              "ProtoBody": {
                  "-children":[
                    { "IndexedLineSet":
                      {
                        "@coordIndex":[0,1,2,3,0,-1],
                        "-coord":
                          { "Coordinate":
                            {
                              "@point":[-0.5,-0.5,0,0.5,-0.5,0,0.5,0.5,0,-0.5,0.5,0]
                            }
                          }
                      }
                    }
                  ]
              }
            }
          },
          { "ProtoDeclare":
            {
              "@name":"BBox2",
              "ProtoInterface": {
                  "field": [
                    {
                      "@name":"translation",
                      "@accessType":"inputOutput",
                      "@type":"SFVec3f"
                    },
                    {
                      "@name":"scale",
                      "@accessType":"inputOutput",
                      "@type":"SFVec3f",
                      "@value":[1,1,1]
                    },
                    {
                      "@name":"color",
                      "@accessType":"inputOutput",
                      "@type":"SFColor",
                      "@value":[1,1,1]
                    }
                  ]
              },
              "ProtoBody": {
                  "-children":[
                    { "Transform":
                      {
                        "IS": {
                            "connect": [
                              {
                                "@nodeField":"translation",
                                "@protoField":"translation"
                              },
                              {
                                "@nodeField":"scale",
                                "@protoField":"scale"
                              }
                            ]
                        },
                        "-children":[
                          { "Transform":
                            {
                              "@translation":[0.5,-0.5,0],
                              "-children":[
                                { "Shape":
                                  {
                                    "-appearance":
                                      { "Appearance":
                                        {
                                          "-material":
                                            { "Material":
                                              {
                                                "IS": {
                                                    "connect": [
                                                      {
                                                        "@nodeField":"emissiveColor",
                                                        "@protoField":"color"
                                                      }
                                                    ]
                                                }
                                              }
                                            }
                                        }
                                      },
                                    "-geometry":
                                      { "ProtoInstance":
                                        {
                                          "@name":"LineRectangle2D"
                                        }
                                      }
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      }
                    }
                  ]
              }
            }
          },
          { "WorldInfo":
            {
              "@title":"Vertical Text",
              "-metadata":
                { "MetadataSet":
                  {
                    "@name":"Titania",
                    "@DEF":"Titania",
                    "@reference":"http://titania.create3000.de",
                    "-value":[
                      { "MetadataSet":
                        {
                          "@name":"NavigationInfo",
                          "@DEF":"NavigationInfo",
                          "@reference":"http://titania.create3000.de",
                          "-value":[
                            { "MetadataString":
                              {
                                "@name":"type",
                                "@DEF":"type",
                                "@reference":"http://titania.create3000.de",
                                "@value":["EXAMINE"]
                              }
                            }
                          ]
                        }
                      },
                      { "MetadataSet":
                        {
                          "@name":"Viewpoint",
                          "@DEF":"Viewpoint",
                          "@reference":"http://titania.create3000.de",
                          "-value":[
                            { "MetadataDouble":
                              {
                                "@name":"position",
                                "@DEF":"position",
                                "@reference":"http://titania.create3000.de",
                                "@value":[-0.0552061013877392,6.52955007553101,27.0410003662109]
                              }
                            },
                            { "MetadataDouble":
                              {
                                "@name":"orientation",
                                "@DEF":"orientation",
                                "@reference":"http://titania.create3000.de",
                                "@value":[0,0,1,0]
                              }
                            },
                            { "MetadataDouble":
                              {
                                "@name":"centerOfRotation",
                                "@DEF":"centerOfRotation",
                                "@reference":"http://titania.create3000.de",
                                "@value":[-0.0552061013877392,6.52955007553101,0]
                              }
                            }
                          ]
                        }
                      }
                    ]
                  }
                }
            }
          },
          { "Background":
            {
              "@skyColor":[0.2,0.2,0.2]
            }
          },
          { "Viewpoint":
            {
              "@description":"Viewpoint",
              "@position":[-0.0552061,6.52955,27.041],
              "@centerOfRotation":[-0.0552061,6.52955,0]
            }
          },
          { "Transform":
            {
              "@DEF":"RedBox",
              "@translation":[-0.5,0.5,0],
              "-children":[
                { "Shape":
                  {
                    "-appearance":
                      { "Appearance":
                        {
                          "-material":
                            { "Material":
                              {
                                "@diffuseColor":[1,0,0],
                                "@transparency":0.5
                              }
                            }
                        }
                      },
                    "-geometry":
                      { "Box":
                        {
                          "@size":[1,1,1]
                        }
                      }
                  }
                }
              ]
            }
          },
          { "Transform":
            {
              "@DEF":"GreenBox",
              "@translation":[-0.5,-0.5,0],
              "-children":[
                { "Shape":
                  {
                    "-appearance":
                      { "Appearance":
                        {
                          "-material":
                            { "Material":
                              {
                                "@diffuseColor":[0,1,0],
                                "@transparency":0.5
                              }
                            }
                        }
                      },
                    "-geometry":
                      { "Box":
                        {
                          "@size":[1,1,1]
                        }
                      }
                  }
                }
              ]
            }
          },
          { "Transform":
            {
              "@DEF":"BlueBox",
              "@translation":[-0.5,-1.5,0],
              "-children":[
                { "Shape":
                  {
                    "-appearance":
                      { "Appearance":
                        {
                          "-material":
                            { "Material":
                              {
                                "@diffuseColor":[0,0,1],
                                "@transparency":0.5
                              }
                            }
                        }
                      },
                    "-geometry":
                      { "Box":
                        {
                          "@size":[1,1,1]
                        }
                      }
                  }
                }
              ]
            }
          },
          { "Transform":
            {
              "@DEF":"YellowBox",
              "@translation":[6,1.5,0],
              "@scale":[12,1,1],
              "-children":[
                { "Shape":
                  {
                    "-appearance":
                      { "Appearance":
                        {
                          "-material":
                            { "Material":
                              {
                                "@diffuseColor":[1,1,0],
                                "@transparency":0.49
                              }
                            }
                        }
                      },
                    "-geometry":
                      { "Box":
                        {
                          "@size":[1,1,1]
                        }
                      }
                  }
                }
              ]
            }
          },
          { "Transform":
            {
              "@DEF":"LineBounds",
              "@translation":[0,16.5214,0],
              "-children":[
                { "ProtoInstance":
                  {
                    "@name":"BBox2",
                    "fieldValue": [
                      {
                        "@name":"scale",
                        "@value":[0.862813,16.5559,1]
                      },
                      {
                        "@name":"color",
                        "@value":[1,0,1]
                      }
                    ]
                  }
                },
                { "ProtoInstance":
                  {
                    "@name":"BBox2",
                    "fieldValue": [
                      {
                        "@name":"translation",
                        "@value":[0.862813,-0.799453,0]
                      },
                      {
                        "@name":"scale",
                        "@value":[1.25,15.7564,1]
                      },
                      {
                        "@name":"color",
                        "@value":[0,1,0]
                      }
                    ]
                  }
                },
                { "ProtoInstance":
                  {
                    "@name":"BBox2",
                    "fieldValue": [
                      {
                        "@name":"translation",
                        "@value":[2.11281,-0.00585938,0]
                      },
                      {
                        "@name":"scale",
                        "@value":[1.25,16.55,1]
                      },
                      {
                        "@name":"color",
                        "@value":[0,0,1]
                      }
                    ]
                  }
                },
                { "ProtoInstance":
                  {
                    "@name":"BBox2",
                    "fieldValue": [
                      {
                        "@name":"translation",
                        "@value":[3.36281,-10.5263,0]
                      },
                      {
                        "@name":"scale",
                        "@value":[1.25,6.02953,1]
                      },
                      {
                        "@name":"color",
                        "@value":[1,1,0]
                      }
                    ]
                  }
                }
              ]
            }
          },
          { "Transform":
            {
              "@DEF":"TextBounds",
              "@translation":[0,16.5214,0],
              "@scale":[4.21559,16.5559,1],
              "-children":[
                { "ProtoInstance":
                  {
                    "@name":"BBox2"
                  }
                }
              ]
            }
          },
          { "Script":
            {
              "@DEF":"Bounds",
              "field": [
                {
                  "@name":"set_lineBounds",
                  "@accessType":"inputOnly",
                  "@type":"MFVec2f"
                },
                {
                  "@name":"set_textBounds",
                  "@accessType":"inputOnly",
                  "@type":"SFVec2f"
                },
                {
                  "@name":"translation_changed",
                  "@accessType":"outputOnly",
                  "@type":"SFVec3f"
                },
                {
                  "@name":"scale_changed",
                  "@accessType":"outputOnly",
                  "@type":"SFVec3f"
                },
                {
                  "@name":"lineBounds",
                  "@accessType":"initializeOnly",
                  "@type":"SFNode",
                  "-children":[
                    { "Transform":
                      {
                        "@USE":"LineBounds"
                      }
                    }
                  ]
                },
                {
                  "@name":"color",
                  "@accessType":"initializeOnly",
                  "@type":"MFColor",
                  "@value":[1,0,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0]
                },
                {
                  "@name":"text",
                  "@accessType":"initializeOnly",
                  "@type":"SFNode",
                  "-children":[
                    { "Text":
                      {
                        "@DEF":"Geo",
                        "@string":[", ","上海市第二中级人民法院2月18日对“复旦投毒案”依法公开, ","一审宣判，被告人林森浩犯故意杀人罪被判死刑，剥夺政治, ","权利终身。2013年4月，复旦大学研究生黄洋因舍友投毒死亡，年仅28岁。!"],
                        "@length":[17.1814,15.7539,16.5724,5.99508],
                        "@maxExtent":16.55,
                        "-fontStyle":
                          { "FontStyle":
                            {
                              "@DEF":"_1",
                              "@family":[", ","Arial Unicode MSARIALUNI.TTF"],
                              "@size":0.5,
                              "@spacing":2.5,
                              "@horizontal":false,
                              "@justify":[", ","ENDBEGIN"]
                            }
                          }
                      }
                    }
                  ]
                }
              ],
              "#sourceText":[
"",
"javascript:",
"",
"var",
"\tBEGIN  = 0,",
"\tFIRST  = 1,",
"\tMIDDLE = 2,",
"\tEND    = 3;",
"",
"function get_normalizedMajorAlignment (majorAlignment, normal)",
"{",
"\tif (majorAlignment == 'END')",
"\t\treturn normal ? END : BEGIN;",
"",
"\tif (majorAlignment == 'MIDDLE')",
"\t\treturn MIDDLE;",
"",
"\treturn normal ? BEGIN : END;",
"",
"}",
"",
"function get_majorAlignment (index)",
"{",
"\tif (text .fontStyle .horizontal)",
"\t{",
"\t\tvar major = get_normalizedMajorAlignment (text .fontStyle .justify [0], text .fontStyle .leftToRight);",
"\t",
"\t\tif (major == END)",
"\t\t\treturn text .textBounds .x - text .lineBounds [index] .x;",
"",
"\t\tif (major == MIDDLE)",
"\t\t\treturn (text .textBounds .x - text .lineBounds [index] .x) / 2;",
"",
"\t\treturn 0;",
"\t}",
"",
"\tvar major = get_normalizedMajorAlignment (text .fontStyle .justify [0], text .fontStyle .topToBottom);",
"\t",
"\tif (major == END)",
"\t\treturn -text .textBounds .y + text .lineBounds [index] .y;",
"",
"\tif (major == MIDDLE)",
"\t\treturn (-text .textBounds .y + text .lineBounds [index] .y) / 2;",
"",
"\treturn 0;",
"}",
"",
"function set_lineBounds (value, time)",
"{",
"\tvar transforms = new MFNode ();",
"\t",
"\tvar",
"\t\tx = 0,",
"\t\ty = 0;",
"\t\t",
"\tfor (var i = 0; i < value .length; ++ i)",
"\t{",
"\t\tvar transform = Browser .currentScene .createProto ('BBox2');",
"\t\t",
"\t\tif (text .fontStyle .horizontal)",
"\t\t{",
"\t\t\ttransform .translation = new SFVec3f (get_majorAlignment (i),",
"\t\t\t                                      text .fontStyle .topToBottom ? y : y - text .textBounds .y,",
"\t\t\t                                      0);",
"\t\t\ty += text .fontStyle .topToBottom ? -value [i] .y : value [i] .y;",
"",
"\t\t\ttransform .scale = new SFVec3f (value [i] .x,",
"\t\t\t                                text .fontStyle .topToBottom ? value [i] .y : -value [i] .y,",
"\t\t\t                                1);",
"\t\t}",
"\t\telse",
"\t\t{",
"\t\t\ttransform .translation = new SFVec3f (text .fontStyle .leftToRight ? x : x + text .textBounds .x,",
"\t\t\t                                      get_majorAlignment (i),",
"\t\t\t                                      0);",
"\t\t",
"\t\t\tx += text .fontStyle .leftToRight ? value [i] .x : -value [i] .x;",
"",
"\t\t\ttransform .scale = new SFVec3f (text .fontStyle .leftToRight ? value [i] .x : -value [i] .x,",
"\t\t\t                                value [i] .y,",
"\t\t\t                                1);",
"\t\t}",
"",
"\t\ttransform .color = color [i % color .length];",
"",
"\t\ttransforms [transforms .length] = transform;",
"\t}",
"",
"\tlineBounds .children = transforms;",
"}",
"",
"function set_textBounds (value, time)",
"{",
"\tscale_changed = new SFVec3f (value .x, value .y, 1);",
"}",
"",
""
]
            }
          },
          { "Transform":
            {
              "@DEF":"Text",
              "-children":[
                { "Shape":
                  {
                    "@DEF":"Shape",
                    "-appearance":
                      { "Appearance":
                        {
                          "-material":
                            { "Material":
                              {
                                "@diffuseColor":[1,0,0],
                                "@specularColor":[0,1,0]
                              }
                            }
                        }
                      },
                    "-geometry":
                      { "Text":
                        {
                          "@USE":"Geo"
                        }
                      }
                  }
                }
              ]
            }
          },
          { "ROUTE":
            {
              "@fromNode":"Bounds",
              "@fromField":"scale_changed",
              "@toNode":"TextBounds",
              "@toField":"set_scale"
            }
          },
          { "ROUTE":
            {
              "@fromNode":"Geo",
              "@fromField":"origin",
              "@toNode":"LineBounds",
              "@toField":"set_translation"
            }
          },
          { "ROUTE":
            {
              "@fromNode":"Geo",
              "@fromField":"origin",
              "@toNode":"TextBounds",
              "@toField":"set_translation"
            }
          },
          { "ROUTE":
            {
              "@fromNode":"Geo",
              "@fromField":"textBounds",
              "@toNode":"Bounds",
              "@toField":"set_textBounds"
            }
          },
          { "ROUTE":
            {
              "@fromNode":"Geo",
              "@fromField":"lineBounds",
              "@toNode":"Bounds",
              "@toField":"set_lineBounds"
            }
          }
        ]
    }
  }
}