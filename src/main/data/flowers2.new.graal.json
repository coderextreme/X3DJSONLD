{ "X3D": {
    "encoding":"UTF-8",
"@profile":"Immersive",
"@version":"4.0",
"@xsd:noNamespaceSchemaLocation":"https://www.web3d.org/specifications/x3d-4.0.xsd",
    "JSON schema":"https://www.web3d.org/specifications/x3d-4.0-JSONSchema.autogenerated.json",
"head": {
"component": [
{
"@name":"Scripting",
"@level":1
}
],
"meta": [
{
"@name":"title",
"@content":"flowers2.x3d"
},
{
"@name":"creator",
"@content":"John Carlson"
},
{
"@name":"transcriber",
"@content":"John Carlson"
},
{
"@name":"created",
"@content":"23 January 2005"
},
{
"@name":"modified",
"@content":"21 March 2018"
},
{
"@name":"description",
"@content":"2 random mathematical roses in spherical dimensions. rho = a + b * cos(c
* theta) * cos(d * phi)"
},
{
"@name":"identifier",
"@content":"https://coderextreme.net/X3DJSONLD/src/main/data/flowers2.x3d"
},
{
"@name":"generator",
"@content":"manually written"
},
{
"@name":"license",
"@content":"https://www.web3d.org/x3d/content/examples/license.html"
},
{
"@name":"translated",
"@content":"03 March 2024"
},
{
"@name":"generator",
"@content":"X3dToJson.xslt, https://www.web3d.org/x3d/stylesheets/X3dToJson.html"
},
{
"@name":"reference",
"@content":"X3D JSON encoding: https://www.web3d.org/wiki/index.php/X3D_JSON_Encoding"
}
]
},
"Scene": {
"-children":[
{ "NavigationInfo":
{
"@avatarSize":[0.15,1.53,0.75]
}
},
{ "Viewpoint":
{
"@description":"Two mathematical orbitals",
"@position":[0,0,50]
}
},
{ "Group":
{
"-children":[
{ "DirectionalLight":
{
"@direction":[1,1,1]
}
},
{ "ProtoDeclare":
{
"@name":"orbit",
"ProtoInterface": {
"field": [
{
"@name":"translation",
"@accessType":"inputOutput",
"@type":"SFVec3f",
"@value":[-8,0,0]
},
{
"@name":"diffuseColor",
"@accessType":"inputOutput",
"@type":"SFColor",
"@value":[1,0.5,0]
},
{
"@name":"specularColor",
"@accessType":"inputOutput",
"@type":"SFColor",
"@value":[1,0.5,0]
},
{
"@name":"transparency",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":0.75
}
]
},
"ProtoBody": {
"-children":[
{ "Group":
{
"-children":[
{ "TimeSensor":
{
"@DEF":"Clock",
"@cycleInterval":16.0,
"@loop":true
}
},
{ "OrientationInterpolator":
{
"@DEF":"OrbitPath",
"@key":[0,0.5,1],
"@keyValue":[1,0,0,0,1,0,0,3.14,1,0,0,6.28]
}
},
{ "Transform":
{
"@DEF":"OrbitTransform",
"IS": {
"connect": [
{
"@nodeField":"translation",
"@protoField":"translation"
}
]
},
"-children":[
{ "Shape":
{
"-children":[
{
"#comment":"&lt;IndexedFaceSet DEF=\"Orbit\" creaseAngle=\"0\"&gt; &lt;Coordinate DEF=\"OrbitCoordinates\"/&gt;
&lt;/IndexedFaceSet&gt;"
}
],
"-appearance":
{ "Appearance":
{
"-material":
{ "Material":
{
"IS": {
"connect": [
{
"@nodeField":"diffuseColor",
"@protoField":"diffuseColor"
},
{
"@nodeField":"specularColor",
"@protoField":"specularColor"
},
{
"@nodeField":"transparency",
"@protoField":"transparency"
}
]
}
}
}
}
},
"-geometry":
{ "IndexedFaceSet":
{
"@DEF":"Orbit",
"@ccw":false,
"@convex":false,
"@coordIndex":[0,1,2,-1],
"-coord":
{ "Coordinate":
{
"@DEF":"OrbitCoordinates",
"@point":[0,0,1,0,1,0,1,0,0]
}
}
}
}
}
}
]
}
},
{ "Script":
{
"@DEF":"OrbitScript",
"field": [
{
"@name":"set_fraction",
"@accessType":"inputOnly",
"@type":"SFFloat"
},
{
"@name":"coordinates",
"@accessType":"outputOnly",
"@type":"MFVec3f"
},
{
"@name":"coordIndexes",
"@accessType":"outputOnly",
"@type":"MFInt32"
},
{
"@name":"e",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":5.0
},
{
"@name":"f",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":5.0
},
{
"@name":"g",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":5.0
},
{
"@name":"h",
"@accessType":"inputOutput",
"@type":"SFFloat",
"@value":5.0
},
{
"@name":"resolution",
"@accessType":"inputOutput",
"@type":"SFInt32",
"@value":50
}
],
"#sourceCode":[
"",
"",
"ecmascript:",
"",
"\t\t\tvar e = 5;",
"\t\t\tvar f = 5;",
"\t\t\tvar g = 5;",
"\t\t\tvar h = 5;",
"\t\t\tvar resolution = 100;",
"",
"\t\t\tfunction initialize() {",
"\t\t\t     generateCoordinates();",
"\t\t\t     var localci = [];",
"\t\t\t     for (var i = 0; i &lt; resolution-1; i++) {",
"\t\t\t\tfor (var j = 0; j &lt; resolution-1; j++) {",
"\t\t\t\t     localci.push(i*resolution+j);",
"\t\t\t\t     localci.push(i*resolution+j+1);",
"\t\t\t\t     localci.push((i+1)*resolution+j+1);",
"\t\t\t\t     localci.push((i+1)*resolution+j);",
"\t\t\t\t     localci.push(-1);",
"\t\t\t\t}",
"\t\t\t    }",
"\t\t\t    coordIndexes = new MFInt32(localci);",
"\t\t\t}",
"",
"\t\t\tfunction generateCoordinates() {",
"\t\t\t     var theta = 0.0;",
"\t\t\t     var phi = 0.0;",
"\t\t\t     var delta = (2 * 3.141592653) / (resolution-1);",
"\t\t\t     var localc = [];",
"\t\t\t     for (var i = 0; i &lt; resolution; i++) {",
"\t\t\t\tfor (var j = 0; j &lt; resolution; j++) {",
"\t\t\t\t\tvar rho = e + f * Math.cos(g * theta) * Math.cos(h * phi);",
"\t\t\t\t\tlocalc.push(new SFVec3f(",
"\t\t\t\t\t\trho * Math.cos(phi) * Math.cos(theta),",
"\t\t\t\t\t\trho * Math.cos(phi) * Math.sin(theta),",
"\t\t\t\t\t\trho * Math.sin(phi)",
"\t\t\t\t\t));",
"\t\t\t\t\ttheta += delta;",
"\t\t\t\t}",
"\t\t\t\tphi += delta;",
"\t\t\t     }",
"\t\t\t     ",
"\t\t\t     coordinates = new MFVec3f(localc);",
"\t\t\t}",
"",
"\t\t\tfunction set_fraction(fraction, eventTime) {",
"\t\t\t\tvar choice = Math.floor(Math.random() * 4);",
"\t\t\t\tswitch (choice) {",
"\t\t\t\tcase 0:",
"\t\t\t\t\te += Math.floor(Math.random() * 2) * 2 - 1;",
"\t\t\t\t\tbreak;",
"\t\t\t\tcase 1:",
"\t\t\t\t\tf += Math.floor(Math.random() * 2) * 2 - 1;",
"\t\t\t\t\tbreak;",
"\t\t\t\tcase 2:",
"\t\t\t\t\tg += Math.floor(Math.random() * 2) * 2 - 1;",
"\t\t\t\t\tbreak;",
"\t\t\t\tcase 3:",
"\t\t\t\t\th += Math.floor(Math.random() * 2) * 2 - 1;",
"\t\t\t\t\tbreak;",
"\t\t\t\t}",
"\t\t\t\tif (e &lt; 1) {",
"\t\t\t\t\tf = 10;",
"\t\t\t\t}",
"\t\t\t\tif (f &lt; 1) {",
"\t\t\t\t\tf = 10;",
"\t\t\t\t}",
"\t\t\t\tif (g &lt; 1) {",
"\t\t\t\t\tg = 4;",
"\t\t\t\t}",
"\t\t\t\tif (h &lt; 1) {",
"\t\t\t\t\th = 4;",
"\t\t\t\t}",
"\t\t\t\tgenerateCoordinates();",
"\t\t\t}",
"",
""
]
}
},
{ "ROUTE":
{
"@fromField":"coordIndexes",
"@fromNode":"OrbitScript",
"@toField":"set_coordIndex",
"@toNode":"Orbit"
}
},
{ "ROUTE":
{
"@fromField":"coordinates",
"@fromNode":"OrbitScript",
"@toField":"point",
"@toNode":"OrbitCoordinates"
}
},
{ "ROUTE":
{
"@fromField":"fraction_changed",
"@fromNode":"Clock",
"@toField":"set_fraction",
"@toNode":"OrbitScript"
}
},
{ "ROUTE":
{
"@fromField":"value_changed",
"@fromNode":"OrbitPath",
"@toField":"rotation",
"@toNode":"OrbitTransform"
}
},
{ "ROUTE":
{
"@fromField":"fraction_changed",
"@fromNode":"Clock",
"@toField":"set_fraction",
"@toNode":"OrbitPath"
}
}
]
}
}
]
}
}
},
{ "ProtoInstance":
{
"@name":"orbit",
"fieldValue": [
{
"@name":"translation",
"@value":[-8,0,0]
},
{
"@name":"diffuseColor",
"@value":[1,0.5,0]
},
{
"@name":"specularColor",
"@value":[1,0.5,0]
},
{
"@name":"transparency",
"@value":0.75
}
]
}
},
{ "ProtoInstance":
{
"@name":"orbit",
"fieldValue": [
{
"@name":"translation",
"@value":[8,0,0]
},
{
"@name":"diffuseColor",
"@value":[0,0.5,1]
},
{
"@name":"specularColor",
"@value":[0,0.5,1]
},
{
"@name":"transparency",
"@value":0.5
}
]
}
}
]
}
}
]
}
  }
}